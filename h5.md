# Palvelinten hallinta - h5

[Tehtävänanto](http://terokarvinen.com/2018/aikataulu-%E2%80%93-palvelinten-hallinta-ict4tn022-3004-ti-ja-3002-to-%E2%80%93-loppukevat-2018-5p)

Käytin tehtävässä omaa [Windows 10 Pro työasemaani](https://www.microsoft.com/fi-fi/p/windows-10-pro/df77x4d43rkt/48DN) ja [Oracle VM VirtualBoxia](https://www.virtualbox.org/),
jossa [Xubuntu 18.04.1 64-bit](https://xubuntu.org/download#lts) ja [Windows 10 64 bit - Edge VM](https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/). Koneen prosessori: Intel Core i5 4690K @ 3.50GHz.

## a) "Säädä Windowsia Saltilla siten, että Windows on orja ja Linux on herra."

Tehtävän aloitus: 26.11.2018 klo 11.04

Olin valmiiksi ladannut VirtualBox imagen [Windows 10 64-bit - MSEdge](https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/) ja importannut sen VirtualBoxiin.

![alt text](https://github.com/Eetu95/Palvelinten-hallinta-ict4tn022-3004/blob/master/Kuvakaappaukset/114.PNG?raw=true)

Tein Linux Xubuntu 18.04.1 64-bit VM:stä masterin. Päivitin ja asensin salt-masterin Linuxiin:

$ sudo apt-get update

$ sudo apt-get upgrade

$ sudo apt-get -y install salt-master

Tarkistin IP-osoitteen, sillä tulen tarvitsemaan sitä myöhemmin:

$ hostname -I

Kokeilin vielä nopeasti salt-master-mininion toimivuutta paikallisesti Xubuntu VM:ssä. Asensin myös salt-minionin:

$ sudo apt-get -y install salt-minion

Otin aikaisemmin tekemäni käyttäjän 'minion1' ja otin siihen ssh:lla yhteyden. Koska minion1 käyttäjällä on myös sudo oikeudet, pysyin
sillä muokkaamaan /etc/salt/minion -tiedoston konfiguraatioita. Laitoin siis masterin IP-osoitteen ja ID:n kohdilleen (ID ei pakollinen)

$ sudo echo -e 'master: (master ip) \nid: minion1'|sudo tee /etc/salt/minion

Käynnistin minionin uudestaan:

$ sudo systemctl restart salt-minion.service

Suljin ssh-yhteyden ja käynnistin vielä masterin uudestaan:

$ sudo systemctl restart salt-master.service

Sitten katsoin oliko hyväksymättömiä avaimia masterilla:

$ sudo salt-key -A

Ilmoituksessa näkyi yksi hyväksymätön avain 'minion1', joten hyväksyin sen (y). Sitten kokeilin vastaako orja:

$ sudo salt minion1 cmd.run 'whoami'



Sitten asensin Windows 10 VM:ään Salt minionin, ohjeet --> http://terokarvinen.com/2018/control-windows-with-salt

![alt text](
